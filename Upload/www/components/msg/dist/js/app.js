(function(e){function t(t){for(var n,a,c=t[0],o=t[1],l=t[2],d=0,p=[];d<c.length;d++)a=c[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],n=!0,c=1;c<s.length;c++){var o=s[c];0!==r[o]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=s[0]))}return e}var n={},r={app:0},i=[];function a(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=n,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=o;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"18f7":function(e,t,s){"use strict";var n=s("acd9"),r=s.n(n);r.a},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var n=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex",attrs:{id:"app"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.errorMsg,expression:"errorMsg"}],staticClass:"callout callout-danger",attrs:{id:"msg-error"}},[e._v("\n    "+e._s(e.errorMsg)+"\n  ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show.list,expression:"show.list"}],staticClass:"list flex-row",class:{height_35:e.show.preview}},[s("Folders",{attrs:{folders:e.folders}}),s("Messages",{attrs:{messages:e.messages}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show.preview,expression:"show.preview"}],staticClass:"preview flex-row"},[s("Bar"),s("Message",{attrs:{message:e.message}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show.form,expression:"show.form"}]},[s("Form")],1)])},i=[],a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"folders flex-2"},[s("ul",e._l(e.folders,(function(t,n){return s("li",{key:n},[s("button",{class:{"btn-primary":"Posteingang"==t.folderName,"btn-success":"Gesendete"==t.folderName,"btn-info":"Archiv"==t.folderName,"btn-danger":"Papierkorb"==t.folderName,"btn-outline":0==t.isStandardFolder},on:{click:function(s){return e.clickHandler(t)}}},[e._v("\n        "+e._s(t.folderName)+"\n      ")])])})),0)])},c=[],o={name:"Folders",props:{folders:Object},created:function(){EventBus.$emit("folders--get",{})},methods:{clickHandler:function(e){EventBus.$emit("messages--changeFolder",{folder:e})}}},l=o,u=s("2877"),d=Object(u["a"])(l,a,c,!1,null,"50c0c995",null),p=d.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages flex-10"},[s("div",{staticClass:"toolbar flex-row"},[s("div",{staticClass:"flex-9"},[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("Neue Nachricht")])]),s("form",{staticClass:"3",attrs:{id:"search"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],attrs:{type:"search",name:"query"},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}})])]),s("GridTemplate",{attrs:{list:e.messages,columns:e.gridColumns,columsHeader:e.gridColumnsHeader,"filter-key":e.searchQuery}})],1)},m=[],h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"gridtemplate"},[s("table",{staticClass:"noselect"},[s("thead",[s("tr",e._l(e.columns,(function(t,n){return s("td",{key:n,class:{active:e.sortKey==t},on:{click:function(s){return e.sortBy(t)}}},[e._v("\n          "+e._s(e.columsHeader[n])+"\n          "),s("i",{staticClass:"fa ",class:{"fa-sort-down":1==e.sortOrders[t],"fa-sort-up":-1==e.sortOrders[t]}})])})),0)]),s("tbody",e._l(e.filteredlist,(function(t,n){return s("tr",{key:n},e._l(e.columns,(function(n,r){return s("td",{key:r},["isRead"==n&&1==t[n]?s("i",{}):"isRead"==n&&0==t[n]?s("i",{staticClass:"fa fa-envelope-o"}):"priority"==n&&"NORMAL"==t[n]?s("i",{}):"priority"==n&&"HIGH"==t[n]?s("i",{staticClass:"fa fa-arrow-up text-red"}):"priority"==n&&"LOW"==t[n]?s("i",{staticClass:"fa fa-arrow-down text-green"}):"hasAttachment"==n&&t[n]?s("i",{staticClass:"fa fa-file-o"}):"hasAttachment"==n&&""==t[n]?s("i",{}):s("span",{on:{click:function(s){return e.clickHandler(t,s)}}},[e._v("\n            "+e._s(t[n])+"\n          ")])])})),0)})),0)])])},v=[],g=(s("55dd"),s("ac6a"),s("456d"),{name:"GridTemplate",template:"#grid-template",props:{list:Array,columns:Array,columsHeader:Array,filterKey:String},data:function(){return{sortKey:"",sortOrders:{},clickHandlerList:[],clickHandlerNode:!1}},computed:{filteredlist:function(){var e=this.filterKey&&this.filterKey.toLowerCase(),t=parseInt(this.sortOrders[this.sortKey])||1,s=this.list;e&&(s=s.filter((function(t){return Object.keys(t).some((function(s){return String(t[s]).toLowerCase().indexOf(e)>-1}))})));var n=this;return s&&(s=s.slice().sort((function(e,s){return"timeFormat"==n.sortKey?(e=e["messageTime"],s=s["messageTime"]):(e=e[n.sortKey],s=s[n.sortKey]),(e===s?0:e>s?1:-1)*t}))),s}},filters:{capitalize:function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}},methods:{clickHandler:function(e,t){if(!e)return!1;this.clickHandlerList=[e],EventBus.$emit("message--open",{message:this.clickHandlerList[0]}),this.clickHandlerNode&&this.clickHandlerNode.classList.remove("text-red"),this.clickHandlerNode=t.target.parentNode.parentNode,this.clickHandlerNode.classList.add("text-red")},sortBy:function(e){if(!e)return!1;this.sortKey=e;var t=parseInt(this.sortOrders[this.sortKey])||1;this.sortKey in this.sortOrders?this.$set(this.sortOrders,this.sortKey,-1*t):(this.sortOrders={},this.$set(this.sortOrders,this.sortKey,1))}}}),b=g,y=(s("18f7"),Object(u["a"])(b,h,v,!1,null,"06fc326e",null)),_=y.exports,x={name:"Messages",components:{GridTemplate:_},props:{messages:Array},data:function(){return{searchQuery:"",gridColumns:["hasAttachment","priority","isRead","subject","senderConnect","timeFormat"],gridColumnsHeader:["","","","Betreff","Sender","Datum"]}},created:function(){},methods:{clickHandler:function(){EventBus.$emit("message--form",{})}}},w=x,k=Object(u["a"])(w,f,m,!1,null,"24903326",null),C=k.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message flex flex-10"},[e.message.id?s("div",{staticClass:"head"},[s("div",[s("label",[e._v("Von")]),e._v(e._s(e.message.senderConnect))]),s("div",[s("label",[e._v("Datum")]),e._v(e._s(e.message.timeFormat))]),s("div",[s("label",[e._v("Betreff")]),"HIGH"==e.message.priority?s("span",{staticClass:"text-red"},[s("i",{staticClass:"fa fa-arrow-up"}),e._v("\n        Wichtig:\n      ")]):"LOW"==e.message.priority?s("i",{staticClass:"fa fa-arrow-down text-green"}):e._e(),e._v("\n      "+e._s(e.message.subject)+"\n    "),s("div",[e.message.hasAttachment?s("div",[s("label",[e._v("Anhang")]),s("i",{staticClass:"fa fa-file-o"}),e._v("\n      "+e._s(e.message.hasAttachment)+"\n    ")]):e._e()]),e.message.id?s("div",{staticClass:"body",domProps:{innerHTML:e._s(e.message.text)}}):e._e()])]):e._e()])},O=[],H={name:"Message",props:{message:Object}},j=H,F=Object(u["a"])(j,S,O,!1,null,"1e801ffc",null),R=F.exports,M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bar flex-2"},[e._v("\n  Bar:\n  "),s("ul",[s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Antworten\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Allen Antworten\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Weiterleiten\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Verschieben\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Archivieren\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Drucken (PDF)\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Löschen\n      ")])])])])},A=[],E={name:"Bar",props:{}},N=E,T=Object(u["a"])(N,M,A,!1,null,"65965b8e",null),$=T.exports,B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form flex-9"},[s("form",{ref:"form",attrs:{action:"index.php?page=MessageCompose&action=send",method:"post",enctype:"multipart/form-data",id:"composeForm"},on:{submit:e.checkForm}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageRecipients,expression:"messageRecipients"}],attrs:{type:"hidden",name:"recipients"},domProps:{value:e.messageRecipients},on:{input:function(t){t.target.composing||(e.messageRecipients=t.target.value)}}}),s("input",{attrs:{type:"hidden",name:"ccrecipients",value:""}}),s("input",{attrs:{type:"hidden",name:"bccrecipients",value:""}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageSubject,expression:"messageSubject"}],attrs:{type:"hidden",name:"messageSubject"},domProps:{value:e.messageSubject},on:{input:function(t){t.target.composing||(e.messageSubject=t.target.value)}}}),s("input",{attrs:{type:"hidden",name:"messageText",value:""}}),s("input",{attrs:{type:"hidden",name:"priority",value:""}}),s("input",{attrs:{type:"hidden",name:"attachments",value:""}}),s("input",{attrs:{type:"hidden",name:"questions",value:""}}),s("input",{attrs:{type:"hidden",name:"readConfirmation",value:""}}),s("input",{attrs:{type:"hidden",name:"forwardMessage",value:""}}),s("input",{attrs:{type:"hidden",name:"replyMessage",value:""}}),s("input",{attrs:{type:"hidden",name:"replyAllMessage",value:""}}),s("input",{attrs:{type:"hidden",name:"dontAllowAnser",value:""}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],staticClass:"hidden",attrs:{name:"messageText"},domProps:{value:e.messageText},on:{input:function(t){t.target.composing||(e.messageText=t.target.value)}}})]),s("div",{staticClass:"bar margin-b-m"},[s("button",{staticClass:"btn btn-blau",on:{click:function(t){return e.clickHandlerSubmitForm()}}},[s("i",{staticClass:"fa fa-paper-plane"}),e._v("Senden")]),s("button",{staticClass:"btn btn-blau",on:{click:function(t){return e.clickHandlerCloseForm()}}},[e._v("Abbrechen")])]),s("ul",[s("li",{staticClass:"flex-row border-b"},[s("label",{staticClass:"flex-1"},[e._v("Empfänger:")]),s("div",{staticClass:"flex-8"},[s("FormRecipient",{directives:[{name:"show",rawName:"v-show",value:e.openRecipients,expression:"openRecipients"}]}),s("button",{staticClass:"btn btn-grau",on:{click:function(t){return e.clickHandlerRecipients()}}},[s("i",{staticClass:"fa fa-plus"})]),s("ul",e._l(e.messageRecipientsArray,(function(t,n){return s("li",{key:n},[e._v(e._s(t.name))])})),0)],1)]),e._m(0),e._m(1),s("li",[s("label",[e._v("Betreff")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageSubject,expression:"messageSubject"}],attrs:{type:"text"},domProps:{value:e.messageSubject},on:{input:function(t){t.target.composing||(e.messageSubject=t.target.value)}}})]),s("li",[s("label",[e._v("Nachricht")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],domProps:{value:e.messageText},on:{input:function(t){t.target.composing||(e.messageText=t.target.value)}}})])])])},K=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",[s("label",[e._v("Kopieempfänger cc:")]),s("button",{staticClass:"btn btn-grau"},[s("i",{staticClass:"fa fa-plus"})])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",[s("label",[e._v("Verdeckte Kopieempfänger bcc:")]),s("button",{staticClass:"btn btn-grau"},[s("i",{staticClass:"fa fa-plus"})])])}],P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-row height_35 bg-white"},[s("div",{staticClass:"flex-1 flex"},[s("button",{on:{click:function(t){return e.clickHandlerRecipientsTabOpen("tab-1")}}},[e._v("Allgemein")]),s("button",{on:{click:function(t){return e.clickHandlerRecipientsTabOpen("tab-2")}}},[e._v("Lehrer")]),s("button",[e._v("Schüler")]),s("button",[e._v("Eltern")])]),s("div",{staticClass:"flex-1"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"tab-1"==e.recipientsTabOpen,expression:"recipientsTabOpen == 'tab-1'"}],staticClass:"tab flex"},[s("button",[e._v("Schulleitung")]),s("button",[e._v("Sekretariat")]),s("button",[e._v("OGS")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"tab-2"==e.recipientsTabOpen,expression:"recipientsTabOpen == 'tab-2'"}],staticClass:"tab flex"},[s("button",{on:{click:function(t){return e.clickHandlerRecipientsLehrer()}}},[e._v("Lehrer")]),s("button",{on:{click:function(t){return e.clickHandlerRecipientsFachschaft()}}},[e._v("Fachschaft")]),s("button",[e._v("Klassenlehrer")]),s("button",[e._v("Klassenleitungen")])])]),s("div",{staticClass:"flex-1 flex"},e._l(e.recipientsResult,(function(t,n){return s("button",{key:n,class:e.isRecipientSelected(t),on:{click:function(s){return e.clickHandlerRecipientsSelect(t)}}},[e._v(e._s(t.text))])})),0),s("div",{staticClass:"flex-1 flex"},e._l(e.recipientsSelect,(function(t,n){return s("button",{key:n,class:e.isRecipientSelected(t),on:{click:function(s){return e.clickHandlerRecipientsSelect(t)}}},[e._v(e._s(t.name))])})),0)])},G=[],L=(s("7f7f"),s("bc3a").default),D={name:"FormRecipient",components:{},props:{recipientsSelectString:String},data:function(){return{recipientsTabOpen:"tab-1",recipientsSelect:[],recipientsResult:[]}},computed:{},created:function(){},methods:{clickHandlerRecipientsTabOpen:function(e){this.recipientsTabOpen=e},clickHandlerRecipientsLehrer:function(){var e=this;L.get("index.php?page=MessageCompose&action=getTeachersJSON&_type=query",{params:{}}).then((function(t){t.data.results&&(e.recipientsResult=t.data.results)})).catch((function(e){console.log(e)}))},clickHandlerRecipientsFachschaft:function(){this.recipientsResult=[]},clickHandlerRecipientsSelect:function(e){if(!e.id&&!e.key)return!1;e.key&&(e.id=e.key,e.text=e.name);for(var t=!1,s=0,n=this.recipientsSelect.length;s<n;s++)this.recipientsSelect[s].key==e.id&&(t=this.recipientsSelect[s]);if(t){var r=this.recipientsSelect.indexOf(t);r>-1&&this.recipientsSelect.splice(r,1)}else this.recipientsSelect.push({key:e.id,name:e.text});var i="";for(s=0;s<this.recipientsSelect.length;s++)s>0&&(i+=";"),i+=this.recipientsSelect[s]["key"];this.recipientsSelectString=i,EventBus.$emit("message--form--set-recipient",{recipientsString:this.recipientsSelectString,recipientsArray:this.recipientsSelect})},isRecipientSelected:function(e){for(var t=0,s=this.recipientsSelect.length;t<s;t++)if(this.recipientsSelect[t].key==e.id)return"btn-success";return!1}}},I=D,Q=Object(u["a"])(I,P,G,!1,null,"1fbdfb15",null),W=Q.exports,q=(s("bc3a").default,{name:"Form",components:{FormRecipient:W},props:{},data:function(){return{messageText:"",messageSubject:"",messageRecipients:"",messageRecipientsArray:[],openRecipients:!1}},computed:{},created:function(){var e=this;EventBus.$on("message--form--set-recipient",(function(t){e.messageRecipients=t.recipientsString,e.messageRecipientsArray=t.recipientsArray}))},methods:{checkForm:function(e){e.preventDefault()},clickHandlerSubmitForm:function(){this.$refs.form.submit()},clickHandlerCloseForm:function(){EventBus.$emit("message--form--close",{})},clickHandlerRecipients:function(){this.openRecipients=!0}}}),J=q,V=Object(u["a"])(J,B,K,!1,null,"5fe1599a",null),z=V.exports,U=!1;U=U||{userID:1608};var X=s("bc3a").default;X.defaults.headers.common["x-authorization"]="112233";var Y={name:"app",components:{Folders:p,Messages:C,Message:R,Bar:$,Form:z},data:function(){return{folders:{},messages:[],message:{},errorMsg:!1,show:{list:!0,preview:!1,form:!1}}},created:function(){var e=this,t=this;EventBus.$on("message--open",(function(e){var s="rest.php/GetMsgMessage/"+U.userID;e.message.id&&(s+="/"+parseInt(e.message.id)),t.ajaxGet(s,{},(function(e,t){t.message=e.data,t.show.list=!0,t.show.preview=!0,t.showform=!1}),(function(e){t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Message 404)"}))})),EventBus.$on("folders--get",(function(e){t.ajaxGet("rest.php/GetMsgFolders/"+U.userID,{},(function(e,t){t.folders=e.data}),(function(e){t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Folders 404)"}))})),EventBus.$on("messages--changeFolder",(function(e){var s="rest.php/GetMsgMessages/"+U.userID;e.folder.isStandardFolder&&!e.folder.folderID?s+="/"+e.folder.folderName:s+="/"+e.folder.folderID,t.ajaxGet(s,{},(function(e,t){e.data?(console.log(e.data),t.messages=e.data,t.message={},t.show.list=!0,t.show.preview=!1,t.showform=!1):t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Data)"}),(function(e){t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Change Folders 404)"}))})),EventBus.$on("message--form",(function(e){var s="rest.php/GetMsgForm/"+U.userID;t.ajaxGet(s,{},(function(e,t){e.data?(t.show.list=!1,t.show.preview=!1,t.show.form=!0,t.message={},console.log(e.data)):t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Form Data)"}),(function(e){t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Open Form 404)"}))})),EventBus.$on("message--form--close",(function(t){console.log("close form"),e.show.list=!0,e.show.preview=!1,e.show.form=!1})),EventBus.$emit("messages--changeFolder",{folder:{isStandardFolder:!0,folderName:"Posteingang",folderID:0}})},methods:{ajaxGet:function(e,t,s,n,r){var i=this;X.get(e,{params:t}).then((function(e){s&&"function"===typeof s&&s(e,i)})).catch((function(e){e&&"function"===typeof n&&n(e)})).finally((function(){r&&"function"===typeof r&&r()}))}}},Z=Y,ee=Object(u["a"])(Z,r,i,!1,null,null,null),te=ee.exports;window.EventBus=new n["a"],n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(te)}}).$mount("#app")},acd9:function(e,t,s){}});
//# sourceMappingURL=app.js.map