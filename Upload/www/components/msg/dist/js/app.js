(function(e){function t(t){for(var n,i,o=t[0],c=t[1],l=t[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],n=!0,o=1;o<s.length;o++){var c=s[o];0!==r[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=s[0]))}return e}var n={},r={app:0},a=[];function i(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=n,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"18f7":function(e,t,s){"use strict";var n=s("acd9"),r=s.n(n);r.a},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var n=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex",attrs:{id:"app"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.errorMsg,expression:"errorMsg"}],staticClass:"callout callout-danger",attrs:{id:"msg-error"}},[e._v("\n    "+e._s(e.errorMsg)+"\n  ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show.list,expression:"show.list"}],staticClass:"list flex-row",class:{height_35:e.show.preview}},[s("Folders",{attrs:{folders:e.folders}}),s("Messages",{attrs:{messages:e.messages}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show.preview,expression:"show.preview"}],staticClass:"preview flex-row"},[s("Bar"),s("Message",{attrs:{message:e.message}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show.form,expression:"show.form"}]},[s("button",{on:{click:function(t){return e.clickHandlerCloseform()}}},[e._v("Close")]),s("Form")],1)])},a=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"folders flex-2"},[s("ul",e._l(e.folders,(function(t,n){return s("li",{key:n},[s("button",{class:{"btn-primary":"Posteingang"==t.folderName,"btn-success":"Gesendete"==t.folderName,"btn-info":"Archiv"==t.folderName,"btn-danger":"Papierkorb"==t.folderName,"btn-outline":0==t.isStandardFolder},on:{click:function(s){return e.clickHandler(t)}}},[e._v("\n        "+e._s(t.folderName)+"\n      ")])])})),0)])},o=[],c={name:"Folders",props:{folders:Object},created:function(){EventBus.$emit("folders--get",{})},methods:{clickHandler:function(e){EventBus.$emit("messages--changeFolder",{folder:e})}}},l=c,u=s("2877"),d=Object(u["a"])(l,i,o,!1,null,"50c0c995",null),p=d.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages flex-9"},[s("div",{staticClass:"toolbar flex-row"},[s("div",{staticClass:"flex-9"},[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("Neue Nachricht")])]),s("form",{staticClass:"3",attrs:{id:"search"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],attrs:{type:"search",name:"query"},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}})])]),s("GridTemplate",{attrs:{list:e.messages,columns:e.gridColumns,columsHeader:e.gridColumnsHeader,"filter-key":e.searchQuery}})],1)},m=[],v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"gridtemplate"},[s("table",{staticClass:"noselect"},[s("thead",[s("tr",e._l(e.columns,(function(t,n){return s("td",{key:n,class:{active:e.sortKey==t},on:{click:function(s){return e.sortBy(t)}}},[e._v("\n          "+e._s(e.columsHeader[n])+"\n          "),s("i",{staticClass:"fa ",class:{"fa-sort-down":1==e.sortOrders[t],"fa-sort-up":-1==e.sortOrders[t]}})])})),0)]),s("tbody",e._l(e.filteredlist,(function(t,n){return s("tr",{key:n},e._l(e.columns,(function(n,r){return s("td",{key:r},["isRead"==n&&1==t[n]?s("i",{}):"isRead"==n&&0==t[n]?s("i",{staticClass:"fa fa-envelope-o"}):"priority"==n&&"NORMAL"==t[n]?s("i",{}):"priority"==n&&"HIGH"==t[n]?s("i",{staticClass:"fa fa-arrow-up text-red"}):"priority"==n&&"LOW"==t[n]?s("i",{staticClass:"fa fa-arrow-down text-green"}):"hasAttachment"==n&&t[n]?s("i",{staticClass:"fa fa-file-o"}):"hasAttachment"==n&&""==t[n]?s("i",{}):s("span",{on:{click:function(s){return e.clickHandler(t,s)}}},[e._v("\n            "+e._s(t[n])+"\n          ")])])})),0)})),0)])])},h=[],g=(s("55dd"),s("ac6a"),s("456d"),{name:"GridTemplate",template:"#grid-template",props:{list:Array,columns:Array,columsHeader:Array,filterKey:String},data:function(){return{sortKey:"",sortOrders:{},clickHandlerList:[],clickHandlerNode:!1}},computed:{filteredlist:function(){var e=this.filterKey&&this.filterKey.toLowerCase(),t=parseInt(this.sortOrders[this.sortKey])||1,s=this.list;e&&(s=s.filter((function(t){return Object.keys(t).some((function(s){return String(t[s]).toLowerCase().indexOf(e)>-1}))})));var n=this;return s&&(s=s.slice().sort((function(e,s){return"timeFormat"==n.sortKey?(e=e["messageTime"],s=s["messageTime"]):(e=e[n.sortKey],s=s[n.sortKey]),(e===s?0:e>s?1:-1)*t}))),s}},filters:{capitalize:function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}},methods:{clickHandler:function(e,t){if(!e)return!1;this.clickHandlerList=[e],EventBus.$emit("message--open",{message:this.clickHandlerList[0]}),this.clickHandlerNode&&this.clickHandlerNode.classList.remove("text-red"),this.clickHandlerNode=t.target.parentNode.parentNode,this.clickHandlerNode.classList.add("text-red")},sortBy:function(e){if(!e)return!1;this.sortKey=e;var t=parseInt(this.sortOrders[this.sortKey])||1;this.sortKey in this.sortOrders?this.$set(this.sortOrders,this.sortKey,-1*t):(this.sortOrders={},this.$set(this.sortOrders,this.sortKey,1))}}}),b=g,_=(s("18f7"),Object(u["a"])(b,v,h,!1,null,"06fc326e",null)),y=_.exports,x={name:"Messages",components:{GridTemplate:y},props:{messages:Array},data:function(){return{searchQuery:"",gridColumns:["hasAttachment","priority","isRead","subject","senderConnect","timeFormat"],gridColumnsHeader:["","","","Betreff","Sender","Datum"]}},created:function(){},methods:{clickHandler:function(){EventBus.$emit("message--form",{})}}},w=x,k=Object(u["a"])(w,f,m,!1,null,"669f8c98",null),C=k.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message flex flex-9"},[e.message.id?s("div",{staticClass:"head"},[s("div",[s("label",[e._v("Von")]),e._v(e._s(e.message.senderConnect))]),s("div",[s("label",[e._v("Datum")]),e._v(e._s(e.message.timeFormat))]),s("div",[s("label",[e._v("Betreff")]),"HIGH"==e.message.priority?s("span",{staticClass:"text-red"},[s("i",{staticClass:"fa fa-arrow-up"}),e._v("\n        Wichtig:\n      ")]):"LOW"==e.message.priority?s("i",{staticClass:"fa fa-arrow-down text-green"}):e._e(),e._v("\n      "+e._s(e.message.subject)+"\n    "),s("div",[e.message.hasAttachment?s("div",[s("label",[e._v("Anhang")]),s("i",{staticClass:"fa fa-file-o"}),e._v("\n      "+e._s(e.message.hasAttachment)+"\n    ")]):e._e()]),e.message.id?s("div",{staticClass:"body",domProps:{innerHTML:e._s(e.message.text)}}):e._e()])]):e._e()])},O=[],H={name:"Message",props:{message:Object}},j=H,M=Object(u["a"])(j,S,O,!1,null,"1416adf0",null),F=M.exports,N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bar flex-2"},[e._v("\n  Bar:\n  "),s("ul",[s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Antworten\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Allen Antworten\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Weiterleiten\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Verschieben\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Archivieren\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Drucken (PDF)\n      ")])]),s("li",[s("button",{staticClass:"btn-primary",on:{click:function(t){return e.clickHandler()}}},[e._v("\n        Löschen\n      ")])])])])},T=[],A={name:"Bar",props:{}},E=A,R=Object(u["a"])(E,N,T,!1,null,"65965b8e",null),$=R.exports,B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form flex-9"},[s("ul",[s("li",[e._v("\n        Empfänger:\n        "),s("button",{on:{click:function(t){return e.clickHandlerRecipients()}}},[e._v("add")]),s("div",{staticClass:"flex-row height_35"},[s("div",{staticClass:"flex-1"},[s("button",{on:{click:function(t){return e.clickHandlerRecipientsTabOpen("tab-1")}}},[e._v("Allgemein")]),s("button",{on:{click:function(t){return e.clickHandlerRecipientsTabOpen("tab-2")}}},[e._v("Lehrer")]),s("button",[e._v("Schüler")]),s("button",[e._v("Eltern")])]),s("div",{staticClass:"flex-1"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"tab-1"==e.recipientsTabOpen,expression:"recipientsTabOpen == 'tab-1'"}],staticClass:"tab"},[s("button",[e._v("Schulleitung")]),s("button",[e._v("Sekretariat")]),s("button",[e._v("OGS")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"tab-2"==e.recipientsTabOpen,expression:"recipientsTabOpen == 'tab-2'"}],staticClass:"tab"},[s("button",{on:{click:function(t){return e.clickHandlerRecipientsLehrer()}}},[e._v("Lehrer")]),s("button",{on:{click:function(t){return e.clickHandlerRecipientsFachschaft()}}},[e._v("Fachschaft")]),s("button",[e._v("Klassenlehrer")]),s("button",[e._v("Klassenleitungen")])])]),s("div",{staticClass:"flex-1"},e._l(e.recipientsResult,(function(t,n){return s("button",{key:n,class:e.isRecipientSelected(t),on:{click:function(s){return e.clickHandlerRecipientsSelect(t)}}},[e._v(e._s(t.text)+e._s(t.id))])})),0),s("div",{staticClass:"flex-1"},[e._v("\n\n            "+e._s(e.recipientsSelect)+"\n\n            "),e._l(e.recipientsSelect,(function(t,n){return s("button",{key:n,class:e.isRecipientSelected(t),on:{click:function(s){return e.clickHandlerRecipientsSelect(t)}}},[e._v(e._s(t.text)+e._s(t.id))])}))],2)])]),e._m(0),e._m(1)]),e._v("\n\n    betreff:\n    "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageSubject,expression:"messageSubject"}],attrs:{type:"text"},domProps:{value:e.messageSubject},on:{input:function(t){t.target.composing||(e.messageSubject=t.target.value)}}}),e._v("\n\n    text:\n    "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],domProps:{value:e.messageText},on:{input:function(t){t.target.composing||(e.messageText=t.target.value)}}}),s("hr"),s("form",{attrs:{action:"index.php?page=MessageCompose&action=send",method:"post",enctype:"multipart/form-data",id:"composeForm"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.recipientsSelectString,expression:"recipientsSelectString"}],attrs:{type:"text",name:"recipients"},domProps:{value:e.recipientsSelectString},on:{input:function(t){t.target.composing||(e.recipientsSelectString=t.target.value)}}}),s("input",{attrs:{type:"text",name:"ccrecipients",value:""}}),s("input",{attrs:{type:"text",name:"bccrecipients",value:""}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageSubject,expression:"messageSubject"}],attrs:{type:"text",name:"messageSubject"},domProps:{value:e.messageSubject},on:{input:function(t){t.target.composing||(e.messageSubject=t.target.value)}}}),s("input",{attrs:{type:"text",name:"messageText",value:""}}),s("input",{attrs:{type:"text",name:"priority",value:""}}),s("input",{attrs:{type:"text",name:"attachments",value:""}}),s("input",{attrs:{type:"text",name:"questions",value:""}}),s("input",{attrs:{type:"text",name:"readConfirmation",value:""}}),s("input",{attrs:{type:"text",name:"forwardMessage",value:""}}),s("input",{attrs:{type:"text",name:"replyMessage",value:""}}),s("input",{attrs:{type:"text",name:"replyAllMessage",value:""}}),s("input",{attrs:{type:"text",name:"dontAllowAnser",value:""}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],attrs:{name:"messageText"},domProps:{value:e.messageText},on:{input:function(t){t.target.composing||(e.messageText=t.target.value)}}}),s("button",[e._v("Nachricht senden")])])])},K=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",[e._v("\n        Kopieempfänger cc:\n        "),s("button",[e._v("add")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",[e._v("\n        Verdeckte Kopieempfänger bcc:\n        "),s("button",[e._v("add")])])}],P=s("bc3a").default,G={name:"Form",components:{},props:{},data:function(){return{messageText:"",messageSubject:"",recipientsSelectString:"",recipientsSelect:[],recipientsResult:[],recipientsTabOpen:"tab-1"}},computed:{},created:function(){},methods:{clickHandlerRecipientsTabOpen:function(e){this.recipientsTabOpen=e},isRecipientSelected:function(e){for(var t=0,s=this.recipientsSelect.length;t<s;t++)if(this.recipientsSelect[t].key==e.id)return"btn-success";return!1},clickHandlerRecipientsSelect:function(e){for(var t=!1,s=0,n=this.recipientsSelect.length;s<n;s++)this.recipientsSelect[s].key==e.id&&(t=this.recipientsSelect[s]);if(t){var r=this.recipientsSelect.indexOf(t);r>-1&&this.recipientsSelect.splice(r,1)}else this.recipientsSelect.push({key:e.id,name:e.text});var a="";for(s=0;s<this.recipientsSelect.length;s++)s>0&&(a+=";"),a+=this.recipientsSelect[s]["key"];this.recipientsSelectString=a},clickHandlerRecipientsLehrer:function(){var e=this;P.get("index.php?page=MessageCompose&action=getTeachersJSON&_type=query",{params:{}}).then((function(t){t.data.results&&(e.recipientsResult=t.data.results)})).catch((function(e){console.log(e)}))},clickHandlerRecipientsFachschaft:function(){this.recipientsResult=[]},clickHandlerRecipients:function(){}}},L=G,D=Object(u["a"])(L,B,K,!1,null,"90d8038a",null),I=D.exports,Q=!1;Q=Q||{userID:1608};var W=s("bc3a").default;W.defaults.headers.common["x-authorization"]="112233";var q={name:"app",components:{Folders:p,Messages:C,Message:F,Bar:$,Form:I},data:function(){return{folders:{},messages:[],message:{},errorMsg:!1,show:{list:!0,preview:!1,form:!1}}},created:function(){var e=this;EventBus.$on("message--open",(function(t){var s="rest.php/GetMsgMessage/"+Q.userID;t.message.id&&(s+="/"+parseInt(t.message.id)),e.ajaxGet(s,{},(function(e,t){t.message=e.data,t.show.list=!0,t.show.preview=!0,t.showform=!1}),(function(t){e.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Message 404)"}))})),EventBus.$on("folders--get",(function(t){e.ajaxGet("rest.php/GetMsgFolders/"+Q.userID,{},(function(e,t){t.folders=e.data}),(function(t){e.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Folders 404)"}))})),EventBus.$on("messages--changeFolder",(function(t){var s="rest.php/GetMsgMessages/"+Q.userID;t.folder.isStandardFolder&&!t.folder.folderID?s+="/"+t.folder.folderName:s+="/"+t.folder.folderID,e.ajaxGet(s,{},(function(e,t){e.data?(console.log(e.data),t.messages=e.data,t.message={},t.show.list=!0,t.show.preview=!1,t.showform=!1):t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Data)"}),(function(t){e.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Change Folders 404)"}))})),EventBus.$on("message--form",(function(t){var s="rest.php/GetMsgForm/"+Q.userID;e.ajaxGet(s,{},(function(e,t){e.data?(t.show.list=!1,t.show.preview=!1,t.show.form=!0,t.message={},console.log(e.data)):t.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Form Data)"}),(function(t){e.errorMsg="Es ist leider ein Fehler aufgetreten. (Code:Ajax Open Form 404)"}))})),EventBus.$emit("messages--changeFolder",{folder:{isStandardFolder:!0,folderName:"Posteingang",folderID:0}})},methods:{clickHandlerCloseform:function(){this.show.list=!0,this.show.preview=!1,this.show.form=!1},ajaxGet:function(e,t,s,n,r){var a=this;W.get(e,{params:t}).then((function(e){s&&"function"===typeof s&&s(e,a)})).catch((function(e){e&&"function"===typeof n&&n(e)})).finally((function(){r&&"function"===typeof r&&r()}))}}},J=q,V=Object(u["a"])(J,r,a,!1,null,null,null),z=V.exports;window.EventBus=new n["a"],n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(z)}}).$mount("#app")},acd9:function(e,t,s){}});
//# sourceMappingURL=app.js.map